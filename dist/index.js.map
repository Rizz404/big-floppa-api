{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import http from \"http\";\r\nimport express from \"express\";\r\nimport bodyParser from \"body-parser\";\r\nimport cors from \"cors\";\r\nimport cookieParser from \"cookie-parser\";\r\nimport helmet from \"helmet\";\r\nimport morgan from \"morgan\";\r\nimport session from \"express-session\";\r\nimport passport from \"passport\";\r\nimport \"dotenv/config\";\r\nimport \"reflect-metadata\";\r\nimport myDataSource from \"./config/data-source\";\r\nimport { userRouter } from \"./routes/user.route\";\r\nimport { catRouter } from \"./routes/cat.route\";\r\nimport { catBreedRouter } from \"./routes/catBreed.route\";\r\nimport jwtStrategy from \"./strategies/jwt.strategy\";\r\nimport { authRouter } from \"./routes/auth.route\";\r\nimport localStrategy from \"./strategies/local.strategy\";\r\nimport googleOauth2Strategy from \"./strategies/google.oauth2.strategy\";\r\nimport allowedOrigins from \"./config/allowedOrigins\";\r\nimport { Server } from \"socket.io\";\r\n\r\nconst app = express();\r\nconst PORT = process.env.PORT || 5000;\r\nconst server = http.createServer(app);\r\n\r\n// * Middleware\r\napp.use(bodyParser.json({ limit: \"30mb\" }));\r\napp.use(bodyParser.urlencoded({ limit: \"30mb\", extended: true }));\r\napp.use(\r\n  cors({\r\n    origin: allowedOrigins,\r\n    credentials: true,\r\n    optionsSuccessStatus: 200,\r\n  })\r\n);\r\napp.use(cookieParser());\r\napp.use(\r\n  session({\r\n    secret: process.env.SESSION_SECRET || \"secret\",\r\n    saveUninitialized: true,\r\n    resave: false,\r\n    cookie: { maxAge: 60000 * 60 },\r\n  })\r\n);\r\napp.use(helmet());\r\napp.use(helmet.crossOriginResourcePolicy({ policy: \"cross-origin\" }));\r\napp.use(morgan(\"dev\"));\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\njwtStrategy(passport);\r\ngoogleOauth2Strategy(passport);\r\nlocalStrategy(passport);\r\n\r\n// * Routes\r\napp.use(\"/auth\", authRouter);\r\napp.use(\"/users\", userRouter);\r\napp.use(\"/cats\", catRouter);\r\napp.use(\"/cat-breeds\", catBreedRouter);\r\n\r\n// * Socket io\r\nconst io = new Server(server, {\r\n  cors: {\r\n    origin: allowedOrigins,\r\n    credentials: true,\r\n    optionsSuccessStatus: 200,\r\n  },\r\n});\r\n\r\n// * Server\r\nmyDataSource\r\n  .initialize()\r\n  .then(async () => {\r\n    server.listen(PORT, () => {\r\n      console.log(`Server running on port ${PORT}`);\r\n    });\r\n    console.log(\"Data Source has been initialized!\");\r\n  })\r\n  .catch((err) => {\r\n    console.error(\"Error during Data Source initialization:\", err);\r\n    process.exit(1);\r\n  });\r\n\r\nexport default app;\r\n"],"names":["app","express","PORT","process","env","server","http","createServer","use","bodyParser","json","limit","urlencoded","extended","cors","origin","allowedOrigins","credentials","optionsSuccessStatus","cookieParser","session","secret","SESSION_SECRET","saveUninitialized","resave","cookie","maxAge","helmet","crossOriginResourcePolicy","policy","morgan","passport","initialize","jwtStrategy","googleOauth2Strategy","localStrategy","authRouter","userRouter","catRouter","catBreedRouter","io","Server","myDataSource","then","listen","console","log","catch","err","error","exit"],"mappings":"uFAmFA,iDAAA,yDAnFiB,yDACG,+DACG,6DACN,8DACQ,iEACN,0DACA,kEACC,qEACC,qBACd,yBACA,uEACkB,kDACE,+CACD,mDACK,+EACP,uDACG,6EACD,6FACO,+FACN,oDACJ,iGAEvB,MAAMA,IAAMC,GAAAA,gBAAO,IACnB,MAAMC,KAAOC,QAAQC,GAAG,CAACF,IAAI,EAAI,IACjC,MAAMG,OAASC,aAAI,CAACC,YAAY,CAACP,KAGjCA,IAAIQ,GAAG,CAACC,mBAAU,CAACC,IAAI,CAAC,CAAEC,MAAO,MAAO,IACxCX,IAAIQ,GAAG,CAACC,mBAAU,CAACG,UAAU,CAAC,CAAED,MAAO,OAAQE,SAAU,IAAK,IAC9Db,IAAIQ,GAAG,CACLM,GAAAA,aAAI,EAAC,CACHC,OAAQC,uBAAc,CACtBC,YAAa,KACbC,qBAAsB,GACxB,IAEFlB,IAAIQ,GAAG,CAACW,GAAAA,qBAAY,KACpBnB,IAAIQ,GAAG,CACLY,GAAAA,uBAAO,EAAC,CACNC,OAAQlB,QAAQC,GAAG,CAACkB,cAAc,EAAI,SACtCC,kBAAmB,KACnBC,OAAQ,MACRC,OAAQ,CAAEC,OAAQ,IAAQ,EAAG,CAC/B,IAEF1B,IAAIQ,GAAG,CAACmB,GAAAA,eAAM,KACd3B,IAAIQ,GAAG,CAACmB,eAAM,CAACC,yBAAyB,CAAC,CAAEC,OAAQ,cAAe,IAClE7B,IAAIQ,GAAG,CAACsB,GAAAA,eAAM,EAAC,QACf9B,IAAIQ,GAAG,CAACuB,iBAAQ,CAACC,UAAU,IAC3BhC,IAAIQ,GAAG,CAACuB,iBAAQ,CAACX,OAAO,IACxBa,GAAAA,oBAAW,EAACF,iBAAQ,EACpBG,GAAAA,6BAAoB,EAACH,iBAAQ,EAC7BI,GAAAA,sBAAa,EAACJ,iBAAQ,EAGtB/B,IAAIQ,GAAG,CAAC,QAAS4B,qBAAU,EAC3BpC,IAAIQ,GAAG,CAAC,SAAU6B,qBAAU,EAC5BrC,IAAIQ,GAAG,CAAC,QAAS8B,mBAAS,EAC1BtC,IAAIQ,GAAG,CAAC,cAAe+B,6BAAc,EAGrC,MAAMC,GAAK,IAAIC,gBAAM,CAACpC,OAAQ,CAC5BS,KAAM,CACJC,OAAQC,uBAAc,CACtBC,YAAa,KACbC,qBAAsB,GACxB,CACF,GAGAwB,mBAAY,CACTV,UAAU,GACVW,IAAI,CAAC,UACJtC,OAAOuC,MAAM,CAAC1C,KAAM,KAClB2C,QAAQC,GAAG,CAAC,CAAC,uBAAuB,EAAE5C,KAAK,CAAC,CAC9C,GACA2C,QAAQC,GAAG,CAAC,oCACd,GACCC,KAAK,CAAC,AAACC,MACNH,QAAQI,KAAK,CAAC,2CAA4CD,KAC1D7C,QAAQ+C,IAAI,CAAC,EACf,SAEF,SAAelD"}