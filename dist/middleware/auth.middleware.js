Object.defineProperty(exports,"__esModule",{value:true});function _export(target,all){for(var name in all)Object.defineProperty(target,name,{enumerable:true,get:all[name]})}_export(exports,{auth:function(){return auth},optionalAuth:function(){return optionalAuth}});const _passport=_interop_require_default(require("passport"));function _interop_require_default(obj){return obj&&obj.__esModule?obj:{default:obj}}const auth=(req,res,next)=>{_passport.default.authenticate("jwt",{session:false},(err,user,info)=>{const{refreshToken}=req.cookies;if(err){return res.status(500).json({message:"Authentication error"})}if(!user||!refreshToken){if(info&&info.message){return res.status(401).json({message:info.message})}return res.status(401).json({message:"Unauthorized"})}req.user=user;next()})(req,res,next)};const optionalAuth=(req,res,next)=>{_passport.default.authenticate("jwt",{session:false},(err,user,info)=>{const{refreshToken}=req.cookies;if(err){return res.status(500).json({message:"Authentication error"})}if(user&&refreshToken){req.user=user}else if(info&&info.message){return res.status(401).json({message:info.message})}next()})(req,res,next)};
//# sourceMappingURL=auth.middleware.js.map