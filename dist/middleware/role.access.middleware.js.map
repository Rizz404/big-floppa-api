{"version":3,"sources":["../../src/middleware/role.access.middleware.ts"],"sourcesContent":["import { UserRole } from \"../entity/User.entity\";\r\nimport { RequestHandler } from \"express\";\r\n\r\nconst roleAccess = (role: UserRole): RequestHandler => {\r\n  return (req, res, next) => {\r\n    const user = req.user;\r\n\r\n    console.log(\"User data in middleware:\", user);\r\n\r\n    if (!user) {\r\n      return res.status(401).json({ message: \"Unauthorized\" });\r\n    }\r\n\r\n    const userRole = user.role;\r\n\r\n    console.log(\"User role type:\", typeof userRole);\r\n    console.log(\"Role function type:\", typeof role);\r\n\r\n    if (typeof userRole !== typeof role) {\r\n      return res.status(400).json({\r\n        message: \"Role type mismatch. Please check role values.\",\r\n      });\r\n    }\r\n\r\n    console.log(\"User data in middleware:\", userRole);\r\n    console.log(\"Role function:\", role);\r\n    if (!userRole) {\r\n      return res\r\n        .status(400)\r\n        .json({ message: \"Something wen't wrong, try to login again\" });\r\n    }\r\n\r\n    if (role !== userRole) {\r\n      return res\r\n        .status(403)\r\n        .json({ message: \"You do not have access to this resource\" });\r\n    }\r\n    next();\r\n  };\r\n};\r\n\r\nexport default roleAccess;\r\n"],"names":["roleAccess","role","req","res","next","user","console","log","status","json","message","userRole"],"mappings":"uFAyCA,iDAAA,YAtCA,MAAMA,WAAa,AAACC,OAClB,MAAO,CAACC,IAAKC,IAAKC,QAChB,MAAMC,KAAOH,IAAIG,IAAI,CAErBC,QAAQC,GAAG,CAAC,2BAA4BF,MAExC,GAAI,CAACA,KAAM,CACT,OAAOF,IAAIK,MAAM,CAAC,KAAKC,IAAI,CAAC,CAAEC,QAAS,cAAe,EACxD,CAEA,MAAMC,SAAWN,KAAKJ,IAAI,CAE1BK,QAAQC,GAAG,CAAC,kBAAmB,OAAOI,UACtCL,QAAQC,GAAG,CAAC,sBAAuB,OAAON,MAE1C,GAAI,OAAOU,WAAa,OAAOV,KAAM,CACnC,OAAOE,IAAIK,MAAM,CAAC,KAAKC,IAAI,CAAC,CAC1BC,QAAS,+CACX,EACF,CAEAJ,QAAQC,GAAG,CAAC,2BAA4BI,UACxCL,QAAQC,GAAG,CAAC,iBAAkBN,MAC9B,GAAI,CAACU,SAAU,CACb,OAAOR,IACJK,MAAM,CAAC,KACPC,IAAI,CAAC,CAAEC,QAAS,2CAA4C,EACjE,CAEA,GAAIT,OAASU,SAAU,CACrB,OAAOR,IACJK,MAAM,CAAC,KACPC,IAAI,CAAC,CAAEC,QAAS,yCAA0C,EAC/D,CACAN,MACF,CACF,QAEA,SAAeJ"}