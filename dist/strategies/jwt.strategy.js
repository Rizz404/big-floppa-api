Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function(){return _default}});const _passportjwt=require("passport-jwt");const _Userentity=require("../entity/User.entity");const _datasource=_interop_require_default(require("../config/data-source"));function _interop_require_default(obj){return obj&&obj.__esModule?obj:{default:obj}}const options={jwtFromRequest:_passportjwt.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:process.env.ACCESS_TOKEN||"secret"};const jwtStrategy=passport=>{passport.use(new _passportjwt.Strategy(options,async(payload,done)=>{try{const userRepository=_datasource.default.getRepository(_Userentity.User);const user=await userRepository.findOne({where:{id:payload.id},relations:{profile:true}});if(!user){return done(null,false)}return done(null,user)}catch(error){return done(error,false)}}))};const _default=jwtStrategy;
//# sourceMappingURL=jwt.strategy.js.map